# Linux 开发平台的部署与配置

操作系统课程实验要求学生在类 Unix 环境下进行内核编译与调试工作。考虑到大部分实验终端预装了 Windows 操作系统，本章将详细阐述如何通过 WSL2 架构或虚拟化技术构建标准的 Linux 开发环境。学生需根据计算机硬件配置选择其中一种方案执行。

## 方案一：基于 WSL2 的环境构建

Windows Subsystem for Linux 2 (WSL2) 利用轻量级实用工具虚拟机架构，提供了完整的 Linux 内核兼容性。该方案无需启动庞大的图形界面，资源开销极低，是进行内核开发的推荐方案。

### 系统兼容性检查与组件启用

部署工作主要依赖于 Windows 命令行接口。操作者需首先确认本机 Windows 系统已开启 Hyper-V 虚拟机。在 Windows 桌面环境中，操作者需将鼠标光标移至屏幕左下角的“开始”按钮图标上方，点击鼠标右键，在弹出的系统快捷菜单中选择“Windows PowerShell (管理员)”或“终端 (管理员)”。该操作将启动具有最高权限的命令行交互界面。

在打开的终端窗口中，操作者需输入以下指令并按回车键执行，以激活 WSL 服务并安装默认的 Ubuntu 发行版：

```Bash
wsl --install
```

该指令会自动执行四个步骤：启用“适用于 Linux 的 Windows 子系统”可选组件、启用“虚拟机平台”可选组件、下载最新的 Linux 内核更新包以及下载 Ubuntu 发行版镜像。若终端返回帮助信息而非安装进度，表明当前 Windows 版本过旧，此时需执行 `wsl --install -d Ubuntu` 或通过 Windows Update 更新系统。指令执行完毕后，控制台将提示重启计算机。操作者必须重启设备以使底层虚拟化驱动生效。

### 初始化配置与软件源更新

计算机重启并重新登录 Windows 后，系统会自动弹出一个控制台窗口，开始初始化 Ubuntu 子系统。此过程需要数分钟时间。初始化完成后，控制台将提示创建 UNIX 用户账户。

操作者需在 `Enter new UNIX username:` 提示符后输入自定义的用户名（建议使用全小写字母，例如 `oslab`），随后按回车键确认。接着系统将提示输入密码。在此阶段，控制台具有密码隐藏保护机制，键盘录入的字符不会以星号或圆点显示在屏幕上。操作者需准确输入密码并回车，随后再次输入以确认。

成功进入 Shell 交互界面后，为了保障软件包下载速度与版本兼容性，建议更新软件源索引并升级预装软件。操作者需在终端中依次执行以下指令。执行涉及系统管理的 `sudo` 指令时，系统可能会要求输入上一步设置的用户密码。

```Bash
sudo apt update
sudo apt upgrade -y
```

待上述指令执行完毕，WSL2 环境即构建完成。操作者可通过在 Windows 资源管理器地址栏输入 `\\wsl$` 来访问 Linux 文件系统，或在命令行中通过 `wsl -d wsl版本(如 Ubuntu-20.04)` 访问 。

## 方案二：基于 VMware Workstation 的虚拟机部署

对于需要完整图形化桌面环境（GUI）或希望对实验环境进行快照备份的学生，虚拟机是更为稳健的选择。本节以 VMware Workstation Player（免费个人版）为例说明部署流程。

### 虚拟化软件安装与镜像获取

操作者需访问 VMware 官方网站下载 VMware Workstation Player 安装包，并访问 Ubuntu 官方网站下载 Ubuntu 20.04 LTS Desktop (64-bit) 或任意其他 LTS 版本的 ISO 镜像文件。首先运行 VMware 安装程序，按照向导提示完成宿主机的软件部署。

### 虚拟机实例的创建与硬件分配

启动 VMware Workstation Player，在主界面选择“创建新虚拟机 (Create a New Virtual Machine)”。在弹出的向导窗口中，选择“安装程序光盘映像文件 (iso)”，并点击“浏览”按钮定位至此前下载的 Ubuntu ISO 文件路径。软件通常会自动识别操作系统版本并启用“简易安装”模式。

后续步骤涉及虚拟硬件资源的分配。在命名虚拟机及设置存储路径后，操作者需配置磁盘容量。建议将最大磁盘大小设定为 40GB 或更高，并选择“将虚拟磁盘存储为单个文件”以提高 I/O 性能。点击“自定义硬件”按钮进入详细配置界面，内存（Memory）建议分配 4096MB（4GB）以避免编译内核时发生内存溢出；处理器（Processors）核心数量建议设定为 2 或 4，具体数值应不高于宿主机物理核心总数。

### 操作系统安装与增强功能配置

完成硬件配置后，点击“完成”启动虚拟机。系统将自动引导进入 Ubuntu 安装程序。若启用了简易安装，安装程序将自动完成时区设置、键盘布局检测及系统文件复制，期间无需人工干预。

系统安装完成后，虚拟机将自动重启并进入桌面环境。为了实现宿主机与虚拟机之间的剪贴板共享、文件拖拽及分辨率自适应功能，必须安装 Open-VM-Tools。操作者需点击 Ubuntu 桌面左下角的“显示应用程序”图标，搜索并打开“Terminal”（终端），在其中输入并执行以下指令：

```Bash
sudo apt update
sudo apt install open-vm-tools-desktop -y
```

指令执行完毕后，操作者需重启虚拟机。至此，基于虚拟机的完整 Linux 开发环境已就绪。

## 环境验证

无论采用上述何种方案，操作者均需验证编译工具链的可用性。在 Linux 终端中输入 `gcc --version` 与 `make --version`。若系统输出相应的版本号信息，则表明基础开发环境部署成功，可以进入后续的实验环节。